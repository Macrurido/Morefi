<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Morefi • Morefi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Morefi">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Morefi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/Morefi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Example-Analysis.html">Example-Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Morefi</h1>
            
            <h4 data-toc-skip class="date">25 June 2025</h4>
      

      <div class="d-none name"><code>Morefi.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://macrurido.github.io/Morefi/">Morefi</a></span><span class="op">)</span></span></code></pre></div>
<p>Morefi
<a href="https://github.com/Macrurido/Morefi/" class="external-link"><img src="reference/figures/logo.png" align="right" height="139" alt="Morefi website"></a></p>
<p>Shield: <a href="http://creativecommons.org/licenses/by/4.0/" class="external-link"><img src="https://img.shields.io/badge/License-CC%20BY%204.0-lightgrey.svg" alt="CC BY 4.0"></a></p>
<p>Morefi © 2024 by Hugo Aguirre Villaseñor is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/" class="external-link">Creative Commons
Attribution 4.0 International License</a>.</p>
<p><a href="http://creativecommons.org/licenses/by/4.0/" class="external-link"><img src="https://i.creativecommons.org/l/by/4.0/88x31.png" alt="CC BY 4.0"></a></p>
<div class="section level2">
<h2 id="morefi">Morefi<a class="anchor" aria-label="anchor" href="#morefi"></a>
</h2>
<p>The <em>Morefi</em> package: <em>Morphological Relationships Fitted
by Robust Regression</em>. It is a methodological package developed in R
to analyze the submitted article:</p>
<p>Aguirre-Villaseñor, H., Morales-Bojórquez, E., Cisneros-Mata
(FISH13711). Biometric relationships as a fisheries management tool: A
case study of the bullseye puffer (<em>Sphoeroides annulatus</em>.
Tetraodontidae). Fisheries Research.</p>
<p>In fisheries monitoring, body length is the most commonly measured
parameter because it is quick and easy to obtain. In contrast, measuring
weight requires a level and stable scale, which can be difficult to
secure in field sampling. Biometric relationships are crucial in
fisheries biology. When accurately calculated, these relationships can
be very useful for management purposes, especially for estimating an
organism’s total length or weight based on other body measurements.</p>
<p>Many species are marketed through artisanal fishing in various
commercial forms. However, there are currently no biometric
relationships that allow for predicting live weight (the total weight of
the fish) from the different categories of landed weight, such as fillet
weight, gutted weight, or frozen weight.</p>
<p>The objective of this package is to provide quantitative models for
various morphological relationships that help predict: a) the expected
live weight of different landed weight categories, b) the expected
fillet yield from various commercial presentations, and c) testing the
suitability of fillet yield as a reference point in managing the target
species.</p>
<p>For this purpose, some functions and a vignette were created to
explain the process step by step. Its implementation streamlines the
methodology and enhances the clarity and impact of both the results and
graphical presentations (tables and figures are personalized).</p>
<p>The functions included in the Morefi package enable the evaluation of
length-length, weight-weight and length-weight biometric relationships
using data that exhibit high variability and do not meet the assumptions
necessary for adjustment via least squares. Given this variability, a
robust regression method is employed for analysis. The “robustbase”
package (version 0.99-2) was utilized to fit robust regression models,
using the functions lmrob() for linear and nlrob() for non-linear
regression (Maechler et al., 2024).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of Morefi from <a href="https://github.com/Macrurido/Morefi.git" class="external-link">GitHub</a> using one of
the following options:</p>
<p>Using the <strong>pak</strong> package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"Macrurido/Morefi"</span><span class="op">)</span></span></code></pre></div>
<p>or using the <strong>devtools</strong> package</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Macrurido/Morefi"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-available-in-the-package">Data available in the package<a class="anchor" aria-label="anchor" href="#data-available-in-the-package"></a>
</h2>
<div class="section level3">
<h3 id="bullseye-puffer-measures">Bullseye puffer measures<a class="anchor" aria-label="anchor" href="#bullseye-puffer-measures"></a>
</h3>
<p>To demonstrate how the package functions, we utilize the dataset
<code>botete</code>, containing 1,397 fish across 7 variables: the total
length(LT), standard length (SL), body trunk length (LB), total weight
(WT), body trunk weight (WB), and fillet weight (Wfi) of the bullseye
puffer (<em>Sphoeroides annulatus</em>), collected from the Eastern
Central Pacific. In this dataset, the landing category is included in
the “Fleet” variable, which is categorized as follows: 1 indicates
Fresh, while 2 denotes Frozen-thawed.</p>
<p>To access the data file, the data frame is stored in an object, such
as ‘mydata’.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu">Morefi</span><span class="fu">::</span><span class="va"><a href="../reference/Botete.html">Botete</a></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bullseye-puffer-fish-landings">Bullseye puffer fish landings<a class="anchor" aria-label="anchor" href="#bullseye-puffer-fish-landings"></a>
</h3>
<p>A second dataset <code>Botete_land</code>, provided the Mexican
fishing records of bullseye puffer landed on the Pacific coast in 2023
and their live weight corresponding live weight for each weight category
(kg): total (WT), body trunk (WB) or fillet (Wfi), either Fresh or
Frozen-thawed (SIPESCA, 2024).</p>
<p>To access the data file, the data frame is stored in
<code>catch</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">catch</span> <span class="op">&lt;-</span> <span class="fu">Morefi</span><span class="fu">::</span><span class="va"><a href="../reference/Botete_land.html">Botete_land</a></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="morefi-functions">Morefi functions<a class="anchor" aria-label="anchor" href="#morefi-functions"></a>
</h2>
<p>The Morefi package includes functions that facilitate data analysis
and ensure reproducibility of results.</p>
<div class="section level3">
<h3 id="fn_arss">fn_ARSS<a class="anchor" aria-label="anchor" href="#fn_arss"></a>
</h3>
<p>The function <code>fn_ARSS</code> perform the Coincident Curves Test,
to determine if there are significant differences between the fitted
curves for each database. It is based on the Analysis of the Residual
Sum of Squares (ARSS) (Chen et al. 1992).</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>=</mo><mfrac><mfrac><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>p</mi></msub><mo>−</mo><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>s</mi></msub></mrow><mrow><mn>3</mn><mo>•</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mfrac><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>s</mi></msub></mrow><mrow><mi>N</mi><mo>−</mo><mn>3</mn><mo>•</mo><mi>K</mi></mrow></mfrac></mfrac></mrow><annotation encoding="application/x-tex">F=\frac{\frac{RSS_{p}-RSS_{s}}{3\bullet \left( K-1 \right)}}{\frac{RSS_{s}}{N-3\bullet K}}</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>p</mi></msub><mo>=</mo><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">RSS_{p}= RSS</annotation></semantics></math>
of each regression fitted by pooled data,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><msub><mi>S</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">RSS_{s}</annotation></semantics></math>=
sum of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">RSS</annotation></semantics></math>
of each regression fitted for each individual sample,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>=
total sample size, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
= number of samples in the comparison.</p>
<p>The residual sum of squares
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">RSS</annotation></semantics></math>
and the degrees of freedom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">DF</annotation></semantics></math>
for each fitted regression are previously stored in the
<code>List_TCCT</code> list. For each regression, the calculations are
stored in a data frame <code>T1</code>, which is stored iteratively
using a loop for in a list <code>T</code>.</p>
<p>Inside the function, the RSS and DF for the joined sample are
calculated to perform the F test for two tails
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\alpha/2</annotation></semantics></math>.
The decision criteria is performed: “*” if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>≤</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p-value\le \alpha</annotation></semantics></math>
or “NS” if the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>−</mo><mi>v</mi><mi>a</mi><mi>l</mi><mo>&gt;</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">p-val\gt \alpha</annotation></semantics></math>.</p>
<p>The function requires defining:</p>
<ul>
<li>
<code>List_TCCT</code>: A list with fitted regression results.<br>
</li>
<li>
<code>i</code>: An integer value indicating the ith regression
analyzed.</li>
<li>
<code>alfa</code>: A numerical value that defines the significance
level. The default number is 0.05.</li>
</ul>
<div class="section level4">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h4>
<p>The Total length (LT) - Total weight (WT) was estimated for the
bullseye puffer <em>Sphoeroides annulatus</em> for landed categories:
Fresh, Frozen-thawed (Frozen), Total (All sample) and Joined (sum of
values of Fresh and Frozen). The Residual Sum of Squares (RSS) and the
degrees of freedom (DF) are provided for each data source. In the table
the first row displays the Analysis of Residual Sum of Squares (ARSS),
the p-value (p), and the decision criteria for the ARSS test
(Criteria).</p>
<p>The adjusted models show the following data: Fresh SSR= and DF= 742;
Frozen SSR= 1280131.81 and DF= 651; and the total sample SSR= 6115874.53
and DF= 1395. Values are stored in the table <code>Table_CC</code>, this
is stored in a list, and the name of each item is built with the
acronyms of the model variables (e.g. LTWT).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Table_CC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="fl">4</span>,ncol<span class="op">=</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Lt-WT"</span> </span>
<span><span class="va">Table_CC</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fresh"</span>,<span class="st">"Frozen"</span>,<span class="st">"Total"</span>,<span class="st">"Joined"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Table_CC</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model"</span>,<span class="st">"Category"</span>,<span class="st">"RSS"</span>,<span class="st">"DF"</span>,<span class="st">"ARSS"</span>,<span class="st">"F-table"</span>,<span class="st">"p-value"</span>,<span class="st">"Criteria"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4424418.33</span></span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fl">742</span> </span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1280131.81</span></span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fl">651</span> </span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">6115874.53</span></span>
<span><span class="va">Table_CC</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fl">1395</span> </span>
<span></span>
<span><span class="va">List_ARSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>LTWT<span class="op">=</span><span class="va">Table_CC</span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">ARSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fn_ARSS.html">fn_ARSS</a></span><span class="op">(</span><span class="va">List_ARSS</span>, <span class="va">i</span>,  alfa<span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
Table of the Coincident Curve Test.
</caption>
<thead><tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Category
</th>
<th style="text-align:right;">
RSS
</th>
<th style="text-align:right;">
DF
</th>
<th style="text-align:right;">
ARSS
</th>
<th style="text-align:right;">
F-table
</th>
<th style="text-align:left;">
p-value
</th>
<th style="text-align:left;">
Criteria
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
LT vs. WT
</td>
<td style="text-align:left;">
Fresh
</td>
<td style="text-align:right;">
4424418
</td>
<td style="text-align:right;">
742
</td>
<td style="text-align:right;">
0.0721
</td>
<td style="text-align:right;">
1.0921
</td>
<td style="text-align:left;">
0.05007
</td>
<td style="text-align:left;">
NS
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Frozen
</td>
<td style="text-align:right;">
1280132
</td>
<td style="text-align:right;">
651
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
6115875
</td>
<td style="text-align:right;">
1395
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Joined
</td>
<td style="text-align:right;">
5704550
</td>
<td style="text-align:right;">
1393
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="fn_dfa">fn_dfa<a class="anchor" aria-label="anchor" href="#fn_dfa"></a>
</h3>
<p>This function uses the <code>augment()</code> function from the
<code>broom</code> package to extract the observed values of the
independent variable (x) and dependent variable (y), along with the
weights (wi), fitted values (fitt), and residuals (ei) from the summary
of the fitted model. It then turns these components into tidy
tibbles.</p>
<p>The function <code>augment()</code> does not provide the weights
column for the <code>lmrob()</code> function. The function
<code><a href="../reference/fn_dfa.html">fn_dfa()</a></code> contains a conditional statement that includes
this variable in the output data frame of the linear adjustments.</p>
<p>In order to homogenizes the results, the columns names were renamed
as “y”, “wi”,“x”,“fitt”,and “ei”.</p>
<p>An additional column has been included that codes errors using a
scale based on weighted values: unweighted (u), weighted (w), and
outliers (o)
<code>dfa$scale &lt;- ifelse(df$wi &lt; 0.25, "o", ifelse(df$wi&lt;1, "w", "u"))</code>.</p>
<p>The function requires defining:</p>
<ul>
<li>
<code>eq</code>: Summary of the equation fitted.</li>
</ul>
<div class="section level4">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a>
</h4>
<p>For the bullseye puffer <em>Sphoeroides annulatus</em>, the
length-weight relationship is modeled using the
<code>robustbase::nlm</code> function, with an ordinate input value of a
= 0.1 and a slope of b = 3. The data frame <code>mydata</code> is
sourced from the Morefi::botete package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"y1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span><span class="op">=</span><span class="fl">0.01</span></span>
<span><span class="va">b</span><span class="op">=</span><span class="fl">3</span></span>
<span></span>
<span><span class="va">eq</span> <span class="op">&lt;-</span> <span class="fu">robustbase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustbase/man/nlrob.html" class="external-link">nlrob</a></span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">a</span><span class="op">*</span><span class="va">x1</span><span class="op">^</span><span class="va">b</span>, data<span class="op">=</span> <span class="va">df</span>,</span>
<span>                        start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a<span class="op">=</span> <span class="va">a</span>, b<span class="op">=</span> <span class="va">b</span><span class="op">)</span>,</span>
<span>                        trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fn_dfa.html">fn_dfa</a></span><span class="op">(</span><span class="va">eq</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>
The initial six rows of the table are displayed.
</caption>
<thead><tr>
<th style="text-align:right;">
y
</th>
<th style="text-align:right;">
wi
</th>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
fitt
</th>
<th style="text-align:right;">
ei
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
189.1
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
209.81549
</td>
<td style="text-align:right;">
-20.715491
</td>
</tr>
<tr>
<td style="text-align:right;">
213.4
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
22.0
</td>
<td style="text-align:right;">
242.19890
</td>
<td style="text-align:right;">
-28.798897
</td>
</tr>
<tr>
<td style="text-align:right;">
33.4
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
37.32321
</td>
<td style="text-align:right;">
-3.923211
</td>
</tr>
<tr>
<td style="text-align:right;">
236.7
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
21.0
</td>
<td style="text-align:right;">
209.81549
</td>
<td style="text-align:right;">
26.884508
</td>
</tr>
<tr>
<td style="text-align:right;">
36.0
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
12.0
</td>
<td style="text-align:right;">
37.32321
</td>
<td style="text-align:right;">
-1.323211
</td>
</tr>
<tr>
<td style="text-align:right;">
457.0
</td>
<td style="text-align:right;">
0.5098231
</td>
<td style="text-align:right;">
28.4
</td>
<td style="text-align:right;">
532.50610
</td>
<td style="text-align:right;">
-75.506104
</td>
</tr>
</tbody>
</table>
<p><code>fn_dfa</code>:</p>
<p><code>fn_fig_cs</code>: This function creates an individual plot
displaying the fitted model alongside the observed values, which are
colored according to a weighted color scale.</p>
<p><code>fn_fig_e</code>: The function creates a graph that displays
residuals on the vertical axis and either the independent variable or
predicted values on the horizontal axis, as determined by the
researcher. The residuals are color-coded using a weighted scale.</p>
<p><code>fn_fig_fw</code>: The fitted values of the models for a landed
presentation category were displayed as a multi-panel plot. The observed
data points for each fitted relationship were categorized according to a
weighted color scale.</p>
<p><code>fn_fig_w</code>: The residual structure was analyzed by
graphing<br>
residuals against weighted values. A custom multi-panel plot illustrates
the structure of each fitted relationship, categorized by a
color-weighted scale of values.</p>
<p><code>fn_figs</code>: Creates a customized scatter plot with the
observed values (points), fitted regression (solid line), and its
confidence interval (shaded area).</p>
<p><code>fn_freq</code>: The function calculates a frequency
distribution of data.</p>
<p><code>fn_freqw</code> This is a methodological function to calculate
the percentage frequencies of weights by model adjusted using the robust
regression approach.</p>
<p><code>fn_fyield</code>: Calculates the fillet yield by dividing a
defined weight reference point <strong>bm</strong> by the mean, lower,
and upper confidence interval of 95% (IC95%) of the estimated fillet
weight, respectively.</p>
<p><code>fn_intervals</code>: Calculates a non-parametric confidence and
predicted intervals using the function predFit() from the package
investr (version 1.4.2).</p>
<p><code>fn_R2RV</code>: Calculates a robust version of the coefficient
of determination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>R</mi><mrow><mi>R</mi><mi>V</mi></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">R^{2}_{RV}</annotation></semantics></math>
(Renaud &amp; Victoria-Feser, 2010).</p>
<p><code>fn_summary</code>: Customizes and stores the summary of each
fitted regression.</p>
<p><code>fn_Wlive</code>: The live weight, which is the total weight of
an organism, is estimated based on the weights of different landing
categories, such as eviscerated weight and fillet weight. These
estimates are derived using regression parameters that relate total
weight to the weight of each landing category.</p>
<p><code>fn_xseq</code>: Generates a data frame with a sequence for
independent variables (including minimum and maximum values) and selects
it according to the model.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="more-details">More details<a class="anchor" aria-label="anchor" href="#more-details"></a>
</h2>
<p>For more information, please refer to the respective vignettes, which
offer detailed descriptions of each function, its operations, and
examples.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>To demonstrate how the package works, please follow the step-by-step
process outlined in the “Morefi_steps” vignette, which reconstructs the
results presented in the article by Aguirre-Villaseñor et
al. (FISH13711).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Aguirre-Villaseñor, H., Morales-Bojórquez, E., Cisneros-Mata
(FISH13711). Biometric relationships as a fisheries management tool: A
case study of the bullseye puffer (<em>Sphoeroides annulatus</em>.
Tetraodontidae). Fisheries Research.</p>
<p>Chen, Y., Jackson, D. A., Harvey, H. H. 1992. A comparison of von
Bertalanffy and polynomial functions in modelling fish growth data.
Canadian Journal of Fisheries and Aquatic Sciences 49(6): 1228–1235. <a href="https://doi.org/10.1139/f92-13" class="external-link uri">https://doi.org/10.1139/f92-13</a></p>
<p>Maechler M, Rousseeuw P, Croux C, Todorov V, Ruckstuhl A,
Salibian-Barrera M, Verbeke T, Koller M, Conceicao EL, Anna di Palma M
(2024). robustbase: Basic Robust Statistics. R package version 0.99-4-1,
<a href="http://robustbase.r-forge.r-project.org/" class="external-link uri">http://robustbase.r-forge.r-project.org/</a>.</p>
<p>Renaud, O., Victoria-Feser, M. P. (2010). A robust coefficient of
determination for regression. Journal of Statistical Planning and
Inference. 140(7), 1852-1862. doi: 10.1016/j.jspi.2010.01.008.</p>
<p>SIPESCA. 2024. Sistema de Información de Pesca y Acuacultura –
SIPESCA. Comisión Nacional de Pesca y Acuacultura. <a href="https://sipesca.conapesca.gob.mx" class="external-link uri">https://sipesca.conapesca.gob.mx</a> (accessed 7 February
2024).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hugo Aguirre-Villaseñor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
